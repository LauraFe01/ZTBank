<dashboard>
  <label>Snort Attack Dashboard</label>
  <description>Statistiche visive sugli attacchi rilevati da Snort negli ultimi 7 giorni</description>

  <!-- Trend temporale -->
  <row>
    <panel>
      <title>Attacchi Snort nel tempo</title>
      <chart>
        <search>
          <query>
            index=main sourcetype=snort_alert\
            | rex field=_raw "(?<src_ip>\d{1,3}(?:\.\d{1,3}){3}):\d+\s+->"\
            | timechart span=1h count by src_ip limit=10
          </query>
          <earliest>-7d@d</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">line</option>
      </chart>
    </panel>
  </row>

  <!-- Top IP sorgenti -->
  <row>
    <panel>
      <title>Top IP sorgenti (ultime 48h)</title>
      <chart>
        <search>
          <query>
            index=main sourcetype=snort_alert earliest=-48h\
            | rex field=_raw "(?<src_ip>\d{1,3}(?:\.\d{1,3}){3}):\d+\s+->"\
            | top src_ip limit=10
          </query>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>

    <!-- Top Signature -->
    <panel>
      <title>Top Signature di attacco</title>
      <chart>
        <search>
          <query>
            index=main sourcetype=snort_alert earliest=-7d\
            | rex field=_raw ".*?\\[\\d+:\\d+:\\d+\\] (?&lt;signature&gt;.*?)\\[Classification"\
            | top signature limit=10
          </query>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>

  <!-- Tabella eventi -->
  <row>
    <panel>
      <title>Dettaglio eventi Snort</title>
      <table>
        <search>
          <query>
            index=main sourcetype=snort_alert earliest=-24h\
            | rex field=_raw "(?<src_ip>\d{1,3}(?:\.\d{1,3}){3}):\d+\s+->"\
            | rex field=_raw ".*?\\[\\d+:\\d+:\\d+\\] (?&lt;signature&gt;.*?)\\[Classification"\
            | table _time, src_ip, signature\
            | sort -_time
          </query>
        </search>
      </table>
    </panel>
  </row>
</dashboard>
